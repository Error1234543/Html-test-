<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<title>KRIVA TEST - Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body { 
        font-family: Poppins, sans-serif;
        background:#eef1ff; margin:0; padding:15px;
    }
    .question-box {
        background:white; border-radius:12px; padding:15px;
        box-shadow:0 4px 12px rgba(0,0,0,0.1);
        margin-bottom:20px;
    }
    img { width:100%; border-radius:10px; }
    .options { display:flex; gap:15px; margin-top:15px; }
    .opt {
        flex:1; background:#ddd; padding:15px; border-radius:10px;
        text-align:center; font-size:20px; cursor:pointer;
        transition:0.25s;
    }
    .opt.selected { background:#4b6bff; color:white; }
    .opt.correct { background:#14c746 !important; color:white; }
    .opt.wrong { background:#ff3f3f !important; color:white; }

    #submitBtn {
        width:100%; background:#4b6bff; color:white;
        padding:15px; font-size:20px; border:none;
        border-radius:10px; margin-top:20px;
    }

    .result-box {
        padding:15px; background:white; border-radius:12px;
        box-shadow:0 4px 12px rgba(0,0,0,0.1);
        margin-top:20px; display:none;
    }
</style>
</head>

<body>

<h2 id="title"></h2>
<div id="quiz"></div>
<button id="submitBtn" onclick="submitTest()">Submit</button>

<div id="result" class="result-box"></div>

<script>
// URL se JSON path get karo
const urlParams = new URLSearchParams(window.location.search);
const testPath = urlParams.get("test");

let quizData = [];
let userAnswers = {};

// JSON load
fetch(testPath)
  .then(res => res.json())
  .then(data => {
      quizData = data.questions;
      document.getElementById("title").innerText = data.title;
      loadQuiz();
  });

// Quiz Display
function loadQuiz() {
    let html = "";

    quizData.forEach((q, index) => {
        html += `
        <div class="question-box" id="q${index}">
            <h3>Q${q.number}</h3>
            <img src="${q.image}" alt="Question Image">
            <div class="options">
                ${renderOption(index, "A")}
                ${renderOption(index, "B")}
                ${renderOption(index, "C")}
                ${renderOption(index, "D")}
            </div>
        </div>
        `;
    });

    document.getElementById("quiz").innerHTML = html;
}

function renderOption(qIndex, opt) {
    return `
      <div class="opt" onclick="selectOption(${qIndex}, '${opt}')" id="q${qIndex}_${opt}">
          ${opt}
      </div>
    `;
}

// Option select
function selectOption(qIndex, opt) {
    userAnswers[qIndex] = opt;

    ["A","B","C","D"].forEach(o => {
        document.getElementById(`q${qIndex}_${o}`).classList.remove("selected");
    });

    document.getElementById(`q${qIndex}_${opt}`).classList.add("selected");
}

// Submit test
function submitTest() {
    let correct = 0;
    let wrong = 0;

    quizData.forEach((q, i) => {
        let correctAns = q.answer;
        let userAns = userAnswers[i];

        if (userAns === correctAns) {
            correct++;
            document.getElementById(`q${i}_${correctAns}`).classList.add("correct");
        } else {
            wrong++;
            if (userAns)
                document.getElementById(`q${i}_${userAns}`).classList.add("wrong");

            document.getElementById(`q${i}_${correctAns}`).classList.add("correct");
        }
    });

    document.getElementById("result").style.display = "block";
    document.getElementById("result").innerHTML = `
        <h3>ðŸ“Š Result</h3>
        <p>Correct: ${correct}</p>
        <p>Wrong: ${wrong}</p>
        <p>Total: ${quizData.length}</p>
    `;
}
</script>

</body>
</html>